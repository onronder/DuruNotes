Enhanced Task and Reminder System for Duru Notes
Converting Checklists into Rich Tasks
The existing checklist feature can be extended to formally support tasks with state and metadata. In the editor, each checkbox line (from Editor V2's toolbar) should be treated as an individual task with a completion status (unchecked = open, checked = done). To enrich these tasks, allow additional metadata like due dates and priorities without cluttering the note text. Rather than relying on special inline syntax (e.g. writing (@due 2023-12-01) in the text, which would be unintuitive), a better approach is to use the UI: for example, when the user long-presses or focuses a checkbox line, show an option like ‚ÄúAdd Due Date/Reminder‚Äù. Selecting this would open a date-time picker (and possibly a small form) to set a due date and an optional reminder alarm. Internally, we do not modify the note‚Äôs text to store this metadata; instead, maintain a separate data model for tasks linked to the note. We already have a note_tasks table for this purpose, which stores each task‚Äôs content, completion status, priority, due date, etc.
GitHub
. Each task entry is associated with its parent note (via a noteId foreign key) and carries a position index mapping it to the correct line in the note. This way, the note body remains clean (just ‚Äú- [ ] Task description‚Äù), while the app knows the richer task info from the database. When a due date is set on a task, the UI can visually indicate it by displaying a small calendar icon and date next to the checkbox line in the note‚Äôs view mode, so the user can see at a glance the deadline (e.g. ‚ÄúüìÖ Nov 30, 5:00 PM‚Äù). When the user checks off a task, mark it completed in the tasks table (and store a completion timestamp) ‚Äì the sync logic should then update the note text to - [x] for that line
GitHub
. If the user unchecks it, revert the status to open and update the note text back to - [ ]. This two-way sync keeps the note content and task state consistent. The tasks data model should include fields for completion status, due date, reminder settings, priority level, etc., which we have defined (e.g. status, dueDate, priority in the NoteTask model)
GitHub
GitHub
. We should also ensure that creating or editing a task (via the note or via a task list) updates the note and database together ‚Äì for example, adding a new checkbox line in a note should create a task entry, and editing a task‚Äôs text or metadata in a task manager should update the note‚Äôs line text and vice versa. By using a separate tasks table and UI controls, we avoid any hacky hidden markup in the note, making the feature robust and user-friendly.
Dedicated Task List View (Agenda)
To help users manage all their to-dos without hunting through multiple notes, we will provide a Task List screen that aggregates tasks across all notes. This screen will list all tasks (optionally just open/incomplete ones by default) along with key info like their description, due date, priority, and origin note for context. Users should be able to check off tasks directly from this list, as well as edit or delete them, with changes syncing back to the source note. It‚Äôs useful to include a small note indicator for tasks that come from a note ‚Äì for instance, a label or icon saying ‚ÄúFrom note: Note Title‚Äù next to the task, so the context is clear. (If the task is a standalone one not tied to any note, it might be labeled as ‚ÄúStandalone‚Äù or simply have no note tag.) We have implemented an initial version of this screen with filtering and sorting options: for example, users can filter to show only today‚Äôs tasks, this week‚Äôs, overdue tasks, or high-priority tasks, and sort the list by due date, priority, creation date, or alphabetically. The UI includes controls like a filter menu (All, Today, This Week, Overdue, High Priority) and sort menu (by Due Date, Priority, etc.) for flexibility
GitHub
GitHub
. The task list is best organized into sections by default, grouped by due date timeframe. For instance, we can group tasks into Overdue, Today, Tomorrow, Upcoming (perhaps broken down into This Week/This Month), and No Due Date sections
GitHub
GitHub
. Each section header clearly indicates the category (e.g. ‚ÄúToday‚Äù for tasks due by end of today, ‚ÄúOverdue‚Äù for any task past its due date and not done, etc.), making it easy to scan deadlines. Within each section, tasks can be listed with a checkbox, title, and maybe an inline badge for due date and priority (e.g. a red ‚ÄúHigh‚Äù badge or an icon for priority). We should utilize the existing priority field to visually distinguish high priority or urgent tasks (e.g. exclamation icons or color highlights for urgent tasks). The task list should update in real time as tasks are added or completed ‚Äì using our reactive state management (e.g. a Riverpod provider or stream from the database) to watch the tasks table ensures that if a user checks off a task in this list or in the note, it disappears from the ‚Äúopen‚Äù list automatically
GitHub
GitHub
. Tapping on a task in the list could open a detailed view or directly navigate to the full note (especially if more context is needed); indeed, an ‚ÄúOpen Note‚Äù action can be provided in a swipe menu or context menu on each task item
GitHub
GitHub
. This allows the user to jump to the note where the task resides with one tap. Additionally, we‚Äôll include a floating ‚ÄúNew Task‚Äù button on this screen for quick capture of tasks that aren‚Äôt in a specific note. This lets users add standalone tasks (the app can store them with an empty noteId or in a special ‚Äúinbox‚Äù note) ‚Äì for example, a quick to-do that isn‚Äôt part of a note yet
GitHub
. Creating a task from here would prompt for the task description, an optional due date, and priority (and later, perhaps an option to choose a note or leave it as standalone). In summary, the Task List view becomes a central agenda of all your tasks, with abilities to filter by timeframe or priority, mark tasks complete, and jump to notes, thereby greatly enhancing the to-do management experience within Duru Notes.
Calendar Integration for Task Deadlines
For a more visual way to see tasks over time, we will integrate a Calendar view that highlights days with due tasks. This could be a dedicated Calendar tab or a toggle in the Task List screen. In our implementation, a calendar month grid is provided (showing the current month by default, with navigation to previous/next month)
GitHub
GitHub
. Dates that have one or more tasks due are marked ‚Äì for example, we draw a small dot or colored indicator on those days. If multiple tasks are due on the same day, we might show a number or multiple dots; we‚Äôve chosen to display a single dot (using a different color if any high-priority task is due that day, e.g. red for urgency) and optionally a tiny number next to it for how many tasks
GitHub
GitHub
. This gives a quick overview of which days are busy. The user can tap on a date to focus it and see the list of tasks due that day. Upon selecting a date, we display the tasks (perhaps in a bottom sheet or below the calendar) for that specific day, listing their titles and allowing completion or editing from there
GitHub
GitHub
. This way, the calendar acts as a date filter for tasks. If the user navigates to a different month using the arrows, the app should load the tasks for that month (querying the tasks with due dates in that range) and update the markers
GitHub
GitHub
. This is implemented by fetching tasks in the selected month range and grouping them by date in a map for efficient lookup of which dates have tasks
GitHub
GitHub
. The calendar view helps users plan ahead: for example, they can see that next Friday has 5 tasks (with an urgent one among them indicated by a red dot), so they might prepare to get some done earlier. It complements the list view by offering a time-oriented perspective. We should ensure that the calendar also updates dynamically (or refreshes on month change) so that if a task due date is changed or completed, the calendar indicators update. Overall, the calendar integration transforms the task system into a lightweight schedule planner, allowing users to pick a day and see what‚Äôs due.
Reminders and Notifications for Due Tasks
One of the most valuable enhancements is to enable notifications for tasks with due dates so that users are alerted at the right time. Not every task with a due date will necessarily need a reminder (some users might use due dates as just deadlines without wanting an alarm), so we should provide an option to set a reminder. This could be a simple toggle ‚ÄúRemind me at due time‚Äù when setting the due date, or even the default behavior (e.g. if a due date/time is set, assume a reminder at that exact time, unless the user opts out). Under the hood, when a reminder is enabled for a task, we will schedule a local notification for the specified date and time. We can leverage the existing notification infrastructure in the app ‚Äì the ReminderCoordinator and related services ‚Äì to handle this. In fact, our task data model includes a field to link a task to a scheduled reminder (reminderId) for this purpose
GitHub
. When a task‚Äôs due date (and reminder flag) is set, the app should create a corresponding entry in the reminders system (a time-based reminder) and store its ID with the task. Using the unified ReminderCoordinator API, we can do something like:
final reminderId = await coordinator.createTimeReminder(
  noteId: task.noteId,
  title: 'Task Reminder',
  body: task.content,
  remindAtUtc: task.dueDate!,
  recurrence: RecurrencePattern.none,  // one-time by default
);
This will schedule a one-time notification at the due date/time for the task
GitHub
. (If the task is tied to a note, we use that noteId so that tapping the notification can open the note; for standalone tasks without a note, we might still call it with a special noteId or handle navigation to the Task List.) The notification‚Äôs content should clearly identify the task, e.g. ‚Äúüîî Reminder: Call Alice about project (from Project Notes)‚Äù so the user knows what it is and which note or context it came from. We should also set up the notification tap action to deep-link into the app: ideally, it opens the relevant note and scrolls to the task, or at least opens the Task List or note with the task highlighted. On the technical side, we‚Äôll use the Flutter local_notifications plugin (or our existing native integration) to schedule these alarms on each platform. iOS will require requesting notification permission from the user the first time ‚Äì so ensure the app prompts for permission appropriately when the user tries to set a reminder (to avoid a silent failure). On Android, scheduled notifications will work, but we should also handle device reboot scenarios: Android does not automatically carry over scheduled alarms after a reboot. We might use the plugin‚Äôs capabilities or the ReminderCoordinator‚Äôs logic to re-schedule any pending task reminders when the device restarts or when the app launches, scanning for tasks with due notifications that haven‚Äôt fired yet. It‚Äôs critical to manage updates and cancellations of reminders. If a user adjusts a task‚Äôs due date or reminder setting, we should update the scheduled notification (cancel the old one and schedule a new one at the new time). If a task is completed before its due time, we must cancel its notification to avoid an unnecessary alert
GitHub
. Our task service code already notes that ‚Äúreminder updates/cancellation should be handled by the integration layer‚Äù
GitHub
GitHub
 ‚Äì this is where we implement that integration. For example, after marking a task complete, call coordinator.cancelReminder(task.reminderId) (if we have such a method) or otherwise cancel the scheduled notification via the plugin. Similarly, deleting a task should cancel its notification. We might also provide a daily summary notification as an optional feature: e.g. every morning at 8 AM, send a summary like ‚ÄúYou have 3 tasks due today‚Äù ‚Äì this could be a setting the user can turn on for an overview, but it‚Äôs secondary to individual task alerts. Finally, we can take advantage of the advanced reminder features already present in the app. Since the ReminderCoordinator supports recurring reminders and snooze actions, we could allow for snoozing task reminders and even future recurring tasks. For snooze: when a task reminder pops up, include actions like ‚ÄúSnooze 10 minutes‚Äù or ‚ÄúSnooze to tomorrow‚Äù. Tapping these would invoke our SnoozeReminderService to reschedule the notification appropriately (e.g. +10 minutes or next morning)
GitHub
GitHub
. This gives users flexibility if they can‚Äôt address the task right at the reminder time. For recurring tasks: while tasks are typically one-off, some to-dos repeat (daily habits, weekly chores, etc.). We could support a recurrence pattern on tasks by leveraging the RecurrencePattern in the reminder system
GitHub
. For instance, a task could be set to repeat every week ‚Äì upon completing it, the app could either automatically create a new task for the next occurrence or simply leave it open and move its due date forward. This is an advanced enhancement, but our infrastructure (recurring reminders, etc.) makes it feasible in the future. In summary, notifications will ensure that tasks with deadlines don‚Äôt go unnoticed: the app will actively alert the user at the right time. Implementing this involves scheduling local notifications when due dates are set, and canceling or updating them based on task completion or changes. With these reminder capabilities, Duru Notes evolves beyond a passive note-taking app into an active personal organizer, helping users stay on top of their tasks and commitments.
Future Enhancements and Considerations
Beyond these improvements, there are a few additional enhancements we can consider to make the task and reminder system even more powerful:
Subtasks and Hierarchies: Support nested tasks (sub-tasks) by utilizing the parentTaskId field already present in the note_tasks table
GitHub
. For example, an indented checkbox under another in a note could be treated as a child task. The UI can reflect this hierarchy (e.g. slightly indent child tasks in the list, or group them under collapsible parents). This allows breaking down larger tasks into steps and tracking them together.
Task Labels or Categories: We have a labels field for tasks (JSON array) which could be used to tag tasks with contexts or categories (e.g. ‚Äú#Errands‚Äù, ‚Äú#Work‚Äù). In the future we could expose this feature so users can tag tasks and then filter or search by these tags (similar to note tags, but for tasks).
Time Estimates and Tracking: The data model includes estimatedMinutes and actualMinutes for tasks
GitHub
. A future update could let users assign an estimated duration to a task and later record how long it actually took. This could feed into personal productivity insights or help in scheduling (for instance, knowing a task will take ~30 minutes). While not critical for a basic to-do list, it‚Äôs a valuable feature for power users and is worth considering down the line.
Enhanced Notifications: We might integrate location-based reminders for tasks in the future, using the GeofenceReminderService (if a task is location-specific, like ‚ÄúBuy milk‚Äù triggering when near a grocery store). Additionally, interactive notification actions (like marking a task complete directly from the notification) could streamline workflow. Our notification channels should be set up (e.g. a channel for task due alerts) with appropriate sounds or importance so that task alarms are noticeable
GitHub
.
Cross-Platform Sync and Integration: Ensure that task completion and reminders sync across devices. Since tasks are stored in the database linked to user accounts (and presumably sync via the backend, e.g. Supabase), a user marking a task done on one device should update everywhere. For notifications, this means if a task was completed on Device A, Device B should cancel the scheduled notification (which implies some coordination ‚Äì perhaps the server could push a silent update or we rely on app open events to refresh local schedules). Moreover, integration with external calendars or assistants (exporting due dates to Google Calendar, or using Siri/Google Assistant to add tasks via voice) could be explored to broaden how users interact with tasks.
Each of these future enhancements can further elevate the task management experience. With the foundation of checkbox-to-task conversion, a unified Task List/Agenda, an interactive Calendar view, and robust Reminders/Notifications, Duru Notes‚Äô task system will go from a primitive checklist to a comprehensive personal organizer. All these improvements keep the user‚Äôs workflow in mind ‚Äì making it easy to capture tasks in notes, see everything in one place, and get timely nudges to complete them ‚Äì ultimately ensuring that important tasks don‚Äôt slip through the cracks. 
GitHub
GitHub